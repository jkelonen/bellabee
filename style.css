:root {
    --accent: #f8a8c8; /* pastel pink */
    --pink: #f8a8c8;
    --pink-strong: #f48fb1;
    --yellow: #ffe8a1; /* soft yellow */
    --mint: #bff4e3; /* mint */
    --lilac: #d9c6f7; /* lilac */
    --ink: #534f59;
    --white: #ffffff;

/* Define your colors here for easy customization */
--btn-bg: #fecaca; /* A light, playful red-pink */
--btn-shadow: #ef4444; /* A darker, saturated red for the 3D shadow */
--btn-text: #991b1b; /* A deep red for readable text */
--focus-ring: #fb7185; /* A vibrant color for the focus ring */
}

* { box-sizing: border-box; -webkit-tap-highlight-color: rgba(0,0,0,0); }
html, body { height: 100%; }
body {
    margin: 0;
    font-family: -apple-system, system-ui, 'SF Pro Rounded', 'Avenir Next', 'Nunito', 'Quicksand', 'Segoe UI', sans-serif;
    color: var(--ink);
    background: url('bg.jpg') right center / cover no-repeat;
    overflow: hidden;
    -webkit-user-select: none; user-select: none;
}

#app {
    position: relative;
    width: 100%;
    height: 100vh; /* fallback */
    height: 100svh; /* iOS 16+ */
    height: 100dvh; /* modern */
}

.scene {
    position: absolute; inset: 0;
    display: grid;
    grid-template-rows: 1fr auto;
    align-items: center;
    justify-items: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 300ms ease;
}
.scene.active { opacity: 1; pointer-events: auto; }

.hud {
    z-index: 5; 
    padding: 16px; 
    text-align: center; 
    width: 100%;
    min-height: 80px; /* Reserve space for buttons */
    display: flex;
    align-items: center;
    justify-content: center;
}

.dialog {
    background: rgba(255,255,255,0.8);
    backdrop-filter: blur(6px);
    border: 2px solid var(--pink);
    border-radius: 16px;
    padding: 12px 16px;
    max-width: 90vw; line-height: 1.3; font-weight: 600; font-size: 16px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.08);
}

.btn {
/* --- Basic Setup & Font --- */
position: relative; /* Needed to position the flower pseudo-element */
appearance: none;
border: none;
outline: none;
cursor: pointer;
touch-action: manipulation;

/* --- Core "Gamey" Styling --- */
background-color: var(--btn-bg);
color: var(--btn-text);
padding: 12px 28px;
border-radius: 999px; /* Pill shape */
font-weight: 700;
font-size: 16px;
letter-spacing: 0.5px;
text-transform: uppercase; /* Common in game buttons */

/* --- The 3D Effect & Transitions --- */
/* The shadow creates the "bottom" part of the button */
box-shadow: 0 6px 0 var(--btn-shadow);
transform: translateZ(0);
transition: transform 150ms ease-out, box-shadow 150ms ease-out, visibility 0ms, opacity 300ms ease;

/* --- Hidden state management --- */
visibility: hidden;
opacity: 0;
}

.btn.visible {
visibility: visible;
opacity: 1;
}

/* --- The Flower Decoration --- */
.btn::before {
content: 'ðŸŒ¸';
position: absolute;
top: -4px;
right: 0px;
font-size: 20px;
transform: rotate(15deg);
transition: transform 200ms ease-in-out;
}

/* --- Interactive States --- */

.btn:hover {
/* On hover, lift the button up slightly */
transform: translateY(-2px);
box-shadow: 0 8px 0 var(--btn-shadow); /* Make shadow slightly bigger */
}

.btn:hover::before {
/* On hover, make the flower pop! */
transform: rotate(0deg) scale(1.2);
}

.btn:active {
/* On click, push the button "down" into its shadow */
transform: translateY(4px);
box-shadow: 0 2px 0 var(--btn-shadow); /* Shrink the shadow */
}

/* --- Accessibility: Focus State --- */
.btn:focus-visible {
/* A modern, Tailwind-style focus ring for keyboard users */
box-shadow: 0 0 0 3px #ffffff, 0 0 0 5px var(--focus-ring);
}

.bee-wrap {
    position: absolute; z-index: 3; left: 50%; top: 36%; transform: translate(-50%, -50%);
}
.bee {
    width: 120px; height: 120px;
    animation: bee-bob 2.3s ease-in-out infinite;
    filter: drop-shadow(0 6px 10px rgba(0,0,0,0.12));
}
@keyframes bee-bob { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

/* Intro fly-in */
.bee-fly-in { animation: bee-in 1200ms cubic-bezier(.17,.67,.24,1.04) 1 both; }
@keyframes bee-in {
    0% { transform: translate(-150%, -60%) scale(0.6) rotate(-10deg); opacity: 0; }
    60% { transform: translate(-50%, -52%) scale(1.05) rotate(4deg); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 1; }
}

/* Bee speech bubble */
.bee-speech-bubble { 
    position: absolute; 
    z-index: 4; 
    width: 260px;
    max-width: 90vw;
    /* top and left are set by JS */
    pointer-events: auto; 
    transform: translate(-50%, -100%);
    opacity: 0;
    transition: opacity 300ms ease;
}

/* When positioned above bee */
.bee-speech-bubble.pointer-below { 
    transform: translate(-50%, -100%);
}

/* When positioned below bee */
.bee-speech-bubble.pointer-above { 
    transform: translate(-50%, 0%);
}
.bee-speech-bubble.visible {
    opacity: 1;
}

.bee-speech-bubble .dialog { 
    position: relative; 
}

/* Attention pulse for new/updated dialog text */
.bee-speech-bubble .dialog.attention {
    animation: dialog-attention 620ms ease-out;
}
@keyframes dialog-attention {
    0% { transform: scale(1); box-shadow: 0 6px 18px rgba(0,0,0,0.08); }
    35% { transform: scale(1.06); box-shadow: 0 10px 28px rgba(248,168,200,0.35); }
    100% { transform: scale(1); box-shadow: 0 6px 18px rgba(0,0,0,0.08); }
}

/* Pointer below (speech bubble above bee) */
.bee-speech-bubble.pointer-below .dialog::after { 
    content: ''; 
    position: absolute; 
    left: calc(50% + var(--pointer-offset, 0px)); 
    bottom: -8px; 
    width: 16px; 
    height: 16px; 
    background: rgba(255,255,255,0.8); 
    border-right: 2px solid var(--pink); 
    border-bottom: 2px solid var(--pink); 
    transform: translateX(-50%) rotate(45deg); 
}

/* Pointer above (speech bubble below bee) */
.bee-speech-bubble.pointer-above .dialog::after { 
    content: ''; 
    position: absolute; 
    left: calc(50% + var(--pointer-offset, 0px)); 
    top: -8px; 
    width: 16px; 
    height: 16px; 
    background: rgba(255,255,255,0.8); 
    border-left: 2px solid var(--pink); 
    border-top: 2px solid var(--pink); 
    transform: translateX(-50%) rotate(45deg); 
}

/* Default pointer (fallback) */
.bee-speech-bubble:not(.pointer-above):not(.pointer-below) .dialog::after { 
    content: ''; 
    position: absolute; 
    left: calc(50% + var(--pointer-offset, 0px)); 
    bottom: -8px; 
    width: 16px; 
    height: 16px; 
    background: rgba(255,255,255,0.8); 
    border-right: 2px solid var(--pink); 
    border-bottom: 2px solid var(--pink); 
    transform: translateX(-50%) rotate(45deg); 
}

.speech {
    display: none;
}
.speech.hidden { display: none; }
.speech .dialog {
    display: none;
}



.grid {
    position: relative; z-index: 2;
    width: min(560px, 92vw);
    margin-bottom: 12vh;
    min-height: 40vh;
    display: grid; place-items: center;
}

.flowers-area, .watering-area, .butterfly-area, .grand-area { position: relative; width: 100%; height: 100%; }

.flower { position: absolute; width: 64px; height: 64px; transform: translate(-50%, -50%) scale(0.8); transition: transform 300ms ease; cursor: pointer; touch-action: manipulation; }
.flower.bud { filter: grayscale(0.8) brightness(0.9); opacity: 0.9; }
.flower.bloom { transform: translate(-50%, -50%) scale(1); filter: none; cursor: default; }

.sparkle { position: absolute; width: 10px; height: 10px; border-radius: 50%; background: radial-gradient(circle, #fff, rgba(255,255,255,0) 60%); pointer-events: none; animation: sparkle 700ms ease-out forwards; }
@keyframes sparkle { from { transform: translate(-50%, -50%) scale(0.3); opacity: 0.9; } to { transform: translate(-50%, -80%) scale(1.4); opacity: 0; } }

.watering-can { position: absolute; width: 110px; height: 110px; touch-action: none; z-index: 10; transform: translate(-50%, -50%); transition: transform 200ms ease; }
.watering-can.pouring { transform: translate(-50%, -50%) rotate(65deg); }
.pour-stream { position: absolute; left: 50%; top: 85%; width: 6px; height: 0; background: linear-gradient(180deg, rgba(135,206,235,0.9) 0%, rgba(100,149,237,0.8) 30%, rgba(70,130,180,0.6) 60%, rgba(70,130,180,0.0) 100%); border-radius: 3px; transform-origin: top; pointer-events: none; transition: height 120ms ease; box-shadow: 0 0 4px rgba(135,206,235,0.5); }

.water-droplet { position: absolute; width: 3px; height: 8px; background: radial-gradient(ellipse, rgba(135,206,235,0.9) 0%, rgba(100,149,237,0.7) 50%, rgba(70,130,180,0.3) 100%); border-radius: 50%; pointer-events: none; animation: droplet-fall 800ms ease-in forwards; }

@keyframes droplet-fall { 
    0% { transform: translateY(0) scale(1); opacity: 0.9; } 
    50% { transform: translateY(20px) scale(0.8); opacity: 0.7; } 
    100% { transform: translateY(40px) scale(0.6); opacity: 0; } 
}

.soil { position: absolute; width: 90px; height: 30px; background: #d2b48c; border-radius: 50px; box-shadow: inset 0 6px 10px rgba(0,0,0,0.1); transform: translate(-50%, -50%); }
.soil.dry { filter: saturate(0.8) brightness(1); }
.soil.wet { filter: saturate(1.2) brightness(0.95); }

.cocoon { position: absolute; width: 40px; height: 60px; background: linear-gradient(180deg, #eaddff, #cbb7ff); border: 2px solid #b79ef5; border-radius: 22px; transform: translate(-50%, -50%); box-shadow: inset 0 6px 10px rgba(0,0,0,0.08); cursor: pointer; touch-action: manipulation; }
.butterfly { position: absolute; width: 36px; height: 28px; transform: translate(-50%, -50%); }
.butterfly .wing { position: absolute; width: 50%; height: 100%; background: radial-gradient(circle at 60% 40%, var(--lilac), var(--pink)); border-radius: 50% 60% 60% 50% / 60% 60% 40% 40%; transform-origin: 0% 50%; }
.butterfly .wing.right { left: 50%; transform-origin: 100% 50%; border-radius: 60% 50% 50% 60% / 60% 40% 60% 60%; }
.butterfly .body { position: absolute; left: 50%; top: 10%; width: 6px; height: 80%; background: #5d4d7a; border-radius: 4px; transform: translateX(-50%); }
.butterfly.fly { animation: flutter 1800ms ease-in-out infinite; }
@keyframes flutter { 0% { transform: translate(-50%, -50%) translate(0,0) rotate(-3deg); } 50% { transform: translate(-50%, -50%) translate(var(--dx, 30px), var(--dy, -20px)) rotate(4deg); } 100% { transform: translate(-50%, -50%) translate(0,0) rotate(-3deg); } }
.butterfly .wing.left { animation: flap 280ms ease-in-out infinite; }
.butterfly .wing.right { animation: flap 280ms ease-in-out infinite reverse; }
@keyframes flap { 0%,100% { transform: rotateY(0deg); } 50% { transform: rotateY(50deg); } }

.confetti { position: absolute; top: -10vh; width: 8px; height: 12px; opacity: 0.9; transform: translateY(-20vh) rotate(0deg); animation: fall linear forwards; }
@keyframes fall { to { transform: translateY(120vh) rotate(720deg); } }

.qr-card { position: relative; z-index: 6; background: rgba(255,255,255,0.9); border: 2px solid var(--pink); border-radius: 16px; padding: 16px; box-shadow: 0 10px 20px rgba(0,0,0,0.08); text-align: center; }
.qr-title { font-size: 18px; font-weight: 800; margin-bottom: 12px; }

.credits { position: absolute; bottom: 8px; width: 100%; text-align: center; font-size: 12px; opacity: 0.6; }

@media (prefers-reduced-motion: reduce) {
    * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; }
}
